<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <style>
        @page {
        @bottom-center{
            content: "Generate only for personal purpose. Do not publish this report. Generated for {{client_name}}.";
            font-size: 10px;
            }
        }
    </style>

</head>
<body>
    <h1>GDPR Compliance report</h1>
    <h4>{{target}}</h4>
    <h4>{{generated_date}}</h4>
    <h3>Site score XXXX</h3>
    
    <h2>Resume</h2>
    <table>
        <thead>
            <th>Category</th>
            <th>Score</th>
        </thead>

        <tr>
            <td>Security of connection</td>
            <td>{{scMod.note}}</td>
        </tr>
        <tr>
            <td>Cookies</td>
            <td>XXX</td>
        </tr>
        <tr>
            <td>Web beacons</td>
            <td>XXX</td>
        </tr>
    </table>


    <div class="jump">
        <h2> Security of connection </h2>
        <h3> Grade {{scMod.grade}} with a score of {{scMod.note}}</h3>
        <h2> Protocol used </h2>
        Score : {{scMod.protocol.score}}
        <table>
                <thead>
                    <tr>
                        <th>Protocol</th>

                        {% for protocol, state in scMod.protocol.items()|sort(case_sensitive = False) %}
                        {% if protocol != 'score' %}
                        <th>{{protocol}}</th>
                        {% endif %}
                        {% endfor %}
                    </tr>
                </thead>
                <tr>
                    <td><b>State</b></td>                            
                    {% for protocol, state in scMod.protocol.items()|sort(case_sensitive = False) %}
                    {% if protocol != 'score' %}
                    <td>{{state}}</td>
                    {% endif %}
                    {% endfor %}
                <tr>
        </table>

        <h2> Quality of Key </h2>
        Score : {{scMod.key.score}}</br>
        Size : {{scMod.key.size}}

        <div class="landscape">
            <h2> Cipher details </h2>
            Score : {{scMod.cipher.score}}

            <table>
                <thead>
                    <thead>
					    <tr>
						    <th rowspan="2">Name</th>
						    <th rowspan="2">Key Exchange</th>
						    <th rowspan="2">Authentication</th>
						    <th colspan="3">Cipher</th>
						    <th colspan="2">MAC</th>
					    </tr>
					    <tr>
						    <th>Type</th>
						    <th>Key size</th>
						    <th>Mode</th>
						    <th>Type</th>
						    <th>Size</th>
					    </tr>
				    </thead>
                    </thead>
                    {% for protocol in scMod.cipher|sort(case_sensitive = False) %}
                    {% if protocol != 'score' %}
                    <tr>
                        <td colspan="9">{{protocol}}</td>
                    </tr>

                    {% for cipherSuite in scMod.cipher[protocol] %}
                    <tr>                           
                        <td>{{cipherSuite.suiteName}}</td>
                        <td>{{cipherSuite.kxType}}</td>
                        <td>{{cipherSuite.keyAlg}}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    <tr>
                    {% endfor %}
                    {% endif %}
                    {% endfor %}
            </table>     
        </div>
    </div>

    <div class="jump">
        <h2> Cookies </h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Expiration</th>
                        <th>Score</th>
                        <th>Comment</th>
                    </tr>
                </thead>
                {% for cookie in cookies -%}
                <tr style="background: {{cookie.color}}">                            
                    <td> {{cookie.name}} </td>
                    <td> {{cookie.expiration}} </td>
                    <td> {{cookie.score}} </td>
                    <td> {{cookie.comment}} </td>
                <tr>
                {% endfor %}
                <tr>
                    <td></td>
                    <td> Cookie score </td>
                    <td> {{ cookies | sum(attribute='score') }} </td>
                    <td></td>
                </tr>
            <table>
    </div>

    <div class="jump">
        <h2> Web beacons </h2>    
    </div>

</body>
</html>
