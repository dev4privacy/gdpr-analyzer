<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <style>
        @page {
            @bottom-center{
                content: "Generate only for personal purpose. Do not publish this report. Generated for {{client_name}}.";
                font-size: 10px;
            
            }
        }
        @page{ background: rgb(253, 253, 255) } /* Third page */
        @font-face {
            font-family: Montserrat-Regular;
            src: url(modules/report/templates/Montserrat-Regular.ttf);
        }
    </style>

</head>
<body>
    <div class="header">
        <h1>gdpr-analyzer</h1>
        <div class="header_report">.report</div>
        <div class="header_target">{{target}}</div>
        <div class="header_date">{{generated_date}}</div>
        <div class="header_score">Score : <span class="bad_score">X</span></div>
    </div>
    
    <div class="container">
        <div class="row">
            <div class="col section section_cookie {% if cookies|length < 1 %}notanalyzed{% endif %}">
                <div class="section_title">Cookie</div>
                <div class="section_note section_grade">
                    <span class="section_note_title">Grade</span>
                    <span class="section_note_data">{% if cookies|length %}{{cookies.grade}}{% endif %}</span>
                </div>
                <div class="section_note section_score">
                    <span class="section_note_title">Score</span>
                    <span class="section_note_data">{% if cookies|length %}{{cookies.score}}{% endif %}</span>
                </div>
            </div>
            <div class="col section section_webbeacon {% if wbMod|length < 1 %}notanalyzed{% endif %}">
                <div class="section_title">Web beacon</div>
                <div class="section_note section_grade">
                    <span class="section_note_title">Grade</span>
                    <span class="section_note_data">{% if wbMod|length %}{{wbMod.grade}}{% endif %}</span>
                </div>
                <div class="section_note section_score">
                    <span class="section_note_title">Score</span>
                    <span class="section_note_data">{% if wbMod|length %}{{wbMod.score}}{% endif %}</span>
                </div>
            </div>
            <div class="col section section_crypto {% if scMod|length < 1 %}notanalyzed{% endif %}">
                <div class="section_title">Transmission security</div>
                <div class="section_note section_grade">
                    <span class="section_note_title">Grade</span>
                    <span class="section_note_data">{% if scMod|length %}{{scMod.grade}}{% endif %}</span>
                </div>
                <div class="section_note section_score">
                    <span class="section_note_title">Score</span>
                    <span class="section_note_data">{% if scMod|length %}{{scMod.note}}{% endif %}</span>
                </div>
            </div>
        </div>
    </div>

        
    {% if cookies|length %}
    <div class="jump">
        <h2>Cookie</h2>
        <div class="description">
            <p>
                In this section, we analyze the cookies placed on your computer when you visit a webpage.
                The score is calculated by considering the lifetime of each of them but also the fact that they are
                third-party cookies or not. A grade from A to F is defined according to the score obtained.
            </p>
        </div>
        <div class="flex-container">
            <div class="grade">
                <p>Grade</p>
                <div class="bd-callout red">
                    {{cookies.grade}}
                </div>
            </div>
            <div class="note">
                <p>Score</p>
                <div class="bd-callout green">
                    {{cookies.score}}
                </div>
            </div>
        </div>
        


        <h3>Expiration delay</h3>
        Score : {{cookies.expiry.score}}</br>
        <div class="container protocol">
            <div class="row">
                <div class="col protocol_table">
                    <table>
                        {% for expiry_info, number in cookies.expiry.info.items() %}
                            <tr>
                                <td>{{expiry_info}}</td>
                                <td>{{number}}</td>
                            </tr>
                        {% endfor %}
                    </table>
                </div>
                <div class="col">
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam</p>
                </div>
            </div>
        </div>

        <h3>Third-party cookies</h3>
        Score : {{cookies.third_party.score}}</br>
        <div class="container protocol">
            <div class="row">
                <div class="col protocol_table">
                    <table>
                        {% for third_party_info, number in cookies.third_party.info.items() %}
                            <tr>
                                <td>{{third_party_info}}</td>
                                <td>{{number}}</td>
                            </tr>
                        {% endfor %}
                    </table>
                </div>
                <div class="col">
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam</p>
                </div>
            </div>
        </div>

    </div>
    {% endif %}

    {% if scMod|length %}
    <div class="jump">
        <h2>Security transmission</h2>
        <div class="description">
            <p>
                In this section, we analyze the quality of the security transmission between your computer and the
                server when you visit a webpage. The score is calculated by considering the protocols used, their
                version and the quality of the encryption key. A grade from A to F is defined according to the score
                obtained.
            </p>
        </div>
        <div class="flex-container">
            <div class="grade">
                <p>Grade</p>
                <div class="bd-callout red">
                    {{scMod.grade}}
                </div>
            </div>
            <div class="note">
                <p>Score</p>
                <div class="bd-callout green">
                    {{scMod.note}}
                </div>
            </div>
        </div>
        
        <h3>Enabled SSL/TLS protocol versions</h3>
        Score : {{scMod.protocol.score}}</br>
        <div class="container protocol">
            <div class="row">
                <div class="col protocol_table">
                    <table>
                        {% for protocol, state in scMod.protocol.items()|sort(case_sensitive = False) %}
                            {% if protocol != 'score' %}
                            <tr>
                                <td>{{protocol}}</td>
                                <td  
                                    {% if protocol == 'SSLv2' and state == 'NO'%} class="green"{% endif %}
                                    {% if protocol == 'SSLv2' and state == 'YES'%} class="red"{% endif %}
                                    {% if protocol == 'SSLv3' and state == 'NO'%} class="green"{% endif %}
                                    {% if protocol == 'SSLv3' and state == 'YES'%} class="red"{% endif %}
                                    {% if protocol == 'TLSv1_2' and state == 'YES'%} class="green"{% endif %}
                                    {% if protocol == 'TLSv1_2' and state == 'NO'%} class="red"{% endif %}
                                    {% if protocol == 'TLSv1_3' and state == 'YES'%}class="green"{% endif %}
                                    {% if protocol == 'TLSv1_3' and state == 'NO'%}class="red"{% endif %}
                                    >{{state}}</td>
                            </tr>
                            {% endif %}
                        {% endfor %}
                    </table>
                </div>
                <div class="col">
                    <!--
                    {% if scMod.protocol.score > 0 %}
                    <h4>Why don’t I have a perfect score?</h4>
                    <ol>
                        {% for protocol, state in scMod.protocol.items() %}{% if protocol == 'TLSv1_3' and state == 'NO'%}
                        <li>Your server doesn’t support TLS 1.3</li>
                        {% endif %}{% endfor %}
                    </ol> 
                    {% endif %}
                    
                    {% for protocol, state in scMod.protocol.items() %}
                        {% if protocol == 'TLSv1_3' and state == 'NO'%}
                            <h4>What are the benefits of TLS 1.3?</h4>
                            <p>TLS 1.3 encryption protocol enhances the HTTPS performance and security for all users and provides many improvements in comparison with TLS 1.2 and older. The most prominent one is reduced latency by making the TLS handshake shorter and more efficient before any secure session is established.</p>
                        {% endif %}
                    {% endfor %}
                    -->
                </div>
            </div>
        </div>

        <h3>Certificate</h3>
        Score : {{scMod.certificate.score}}</br>
        <div class="container certificate">
            <div class="row">
                <div class="col protocol_table">
                    <table>
                        <tr>
                            <td>Issued to</td>
                            <td>{{scMod.certificate.issued_to}}</td>
                        </tr>
                        <tr>
                            <td>Issued by</td>
                            <td>{{scMod.certificate.issued_by}}</td>
                        </tr>
                        <tr>
                            <td>Extended Validation</td>
                            <td {% if scMod.certificate.type == 'extended-validation'%} class="green"> YES {% else %}> NO {% endif %}</td>
                        </tr>
                        <tr>
                            <td>Signature algorithml</td>
                            <td>{{scMod.certificate.sign_algo}}</td>
                        </tr>
                        <tr>
                            <td>Valid from</td>
                            <td>{{scMod.certificate.not_before}}</td>
                        </tr>
                        <tr>
                            <td>Valid until</td>
                            <td>{{scMod.certificate.not_after}}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        

        <h3> Quality of Key </h3>
        Score : {{scMod.key.score}}</br>
        Size : {{scMod.key.size}}</br>
        Type : {{scMod.key.type}}

        <div class="landscape">
            <h3> Cipher details </h3>
            Score : {{scMod.cipher.score}}

            <table class="ciphersuite">
                <thead>
				    <tr>
                        <th rowspan="2">Name</th>
					    <th rowspan="2">Key Exchange</th>
					    <th rowspan="2">Auth.</th>
					    <th colspan="3">Cipher</th>
					    <th colspan="2">MAC</th>
				    </tr>
				    <tr>
					    <th>Type</th>
					    <th>Key size</th>
					    <th>Mode</th>
					    <th>Type</th>
					    <th>Size</th>
				    </tr>
			    </thead>
                {% for protocol in scMod.cipher|sort(case_sensitive = False) %}
                {% if protocol != 'score' %}
                <tr>
                    <td colspan="9" class="ciphersuite_protocol"><span class="{% if protocol == 'SSLv2'%} class="bg_red"{% endif %}
                        {% if protocol == 'SSLv3'%} class="bg_red"{% endif %}
                        {% if protocol == 'TLSv1_2'%} class="bg_green"{% endif %}
                        {% if protocol == 'TLSv1_3'%} class="bg_green"{% endif %}">{{protocol}}</span></td>
                </tr>

                {% for cipherSuite in scMod.cipher[protocol] %}
                {% for cipher, info in cipherSuite.items() %}
                <tr>                           
                    {{info.security}}
                    <td {% if info.security == 'insecure'%} class="red"{% endif %}
                        {% if info.security == 'weak'%} class="orange"{% endif %}
                        {% if info.security == 'recommended'%} class="green"{% endif %}
                    >{{cipher}}</td>
                    <td>{{info.key_exch_protocol}}</td>
                    <td>{{info.auth_protocol}}</td>
                    <td>{{info.cipher_type}}</td>
                    <td>{{info.cipher_key_size}}</td>
                    <td>{{info.cipher_mode}}</td>
                    <td>{{info.mac_type}}</td>
                    <td>{{info.mac_size}}</td>
                <tr>
                {% endfor %}
                {% endfor %}
                {% endif %}
                {% endfor %}
            </table>     
        </div>
    </div>
    {% endif %}

    {% if wbMod|length %}
    <div class="jump">
        <h2> Web beacons </h2>
        <div class="description">
            <p>
                In this part, we analyze the web beacons. These are small images found on some web pages that can be used
                to alert other websites to your presence. The score is calculated by taking into account the criteria
                for detecting a potential web beacon. These criteria are their presence in a black list, their small
                size, their position on the web page or the fact that they are voluntarily hidden. A grade from A to F
                is defined according to the score obtained.
            </p>
        </div>
        <div class="flex-container">
            <div class="grade">
                <p>Grade</p>
                <div class="bd-callout red">
                    {{wbMod.grade}}
                </div>
            </div>
            <div class="note">
                <p>Score</p>
                <div class="bd-callout green">
                    {{wbMod.score}}
                </div>
            </div>
        </div>

        <div class="container protocol">
            <div class="row">
                <div class="col protocol_table">
                    <h3> Details </h3>
                    {% if wbMod.url|length %}
                        <div class="webbeacons">
                            {% for url in wbMod.url %}
                                <div class="webbeacon">
                                    <p class="webbeacon_target">wwww.targeet.com</p>
                                    <p><span>Url : </span>{{url.url}}</p>
                                    <p class="fault">Fault : 
                                        {% if url.position == True %}<span>position</span>{% endif %}
                                        {% if url.hidden == True %}<span>hidden</span>{% endif %}
                                        {% if url.size == True %}<span>size</span>{% endif %}
                                        {% if url.blacklist == True %}<span>blacklist</span>{% endif %}
                                    </p>
                                </div>
                            {% endfor %}
                        </div>
                        <div class="caption">
                            <p><span>Size : </span> The size of the image is to small to be watch by the user (minus 3 pixels), there's a high probability that it's a web beacon</p>
                            <p><span>Position : </span> The picture is placed outside the field (in the left and top negatives), there's a high probability that it's a web beacon beacause it's uncommon for a developer to use this kind of practice to insert a legitimate image</p>
                            <p><span>Hidden : </span> The style of the beacon is set to hide the content of the image, there's a high probability that it's a web beacon.</p>
                            <p><span>Blacklist : </span> The source of the beacon if blacklisted in Host-block file from https://sebsauvage.net/hosts/hosts</p>
                        </div>
                    {% else %}
                        <p>Well, no web beacon detected</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}

</body>
</html>
